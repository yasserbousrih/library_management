[
 {
  "breadcrumbs": null,
  "content_type": "HTML",
  "context_script": null,
  "css": null,
  "docstatus": 0,
  "doctype": "Web Page",
  "dynamic_route": 0,
  "dynamic_template": 0,
  "enable_comments": 0,
  "end_date": null,
  "full_width": 1,
  "header": null,
  "insert_style": 0,
  "javascript": null,
  "main_section": null,
  "main_section_html": "<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n  <meta charset=\"UTF-8\" />\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\r\n  <title>Library Management System</title>\r\n  <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css\"/>\r\n  <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css\"/>\r\n  {{ web_block(\"design-system\") }}\r\n  <style>\r\n    /* Hide default Frappe navbar */\r\n    .navbar-frappe,\r\n    .navbar-default,\r\n\r\n    .frappe-header,\r\n    .frappe-navbar {\r\n\r\n\r\n      display: none !important;\r\n    }\r\n    \r\n    /* Ensure our custom navbar is visible */\r\n    .custom-navbar,\r\n    .web-block-navbar {\r\n      display: block !important;\r\n    }\r\n    \r\n    /* Override any hiding for our custom navbar */\r\n    .web-block-navbar .navbar,\r\n    .web-block-navbar .navbar-brand,\r\n    .web-block-navbar .navbar-nav {\r\n      display: block !important;\r\n    }\r\n    \r\n    /* Home page specific styles using design system */\r\n    .home-main { \r\n      max-width: 1200px; \r\n      margin: 0 auto; \r\n      padding: var(--space-16) var(--space-6);\r\n      margin-top: 2rem; /* Add top margin to prevent navbar overlap */\r\n    }\r\n    \r\n    .home-hero {\r\n      text-align: center;\r\n      margin-bottom: var(--space-16);\r\n      padding: var(--space-12) 0;\r\n      background: linear-gradient(135deg, var(--primary-50) 0%, var(--neutral-50) 100%);\r\n      border-radius: var(--radius-2xl);\r\n      position: relative;\r\n      overflow: hidden;\r\n    }\r\n    \r\n    .home-hero::before {\r\n      content: '';\r\n      position: absolute;\r\n      top: 0;\r\n      left: 0;\r\n      right: 0;\r\n      bottom: 0;\r\n      background: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\"><defs><pattern id=\"grain\" width=\"100\" height=\"100\" patternUnits=\"userSpaceOnUse\"><circle cx=\"25\" cy=\"25\" r=\"1\" fill=\"%23e2e8f0\" opacity=\"0.3\"/><circle cx=\"75\" cy=\"75\" r=\"1\" fill=\"%23e2e8f0\" opacity=\"0.3\"/><circle cx=\"50\" cy=\"10\" r=\"0.5\" fill=\"%23e2e8f0\" opacity=\"0.2\"/><circle cx=\"10\" cy=\"60\" r=\"0.5\" fill=\"%23e2e8f0\" opacity=\"0.2\"/><circle cx=\"90\" cy=\"40\" r=\"0.5\" fill=\"%23e2e8f0\" opacity=\"0.2\"/></pattern></defs><rect width=\"100\" height=\"100\" fill=\"url(%23grain)\"/></svg>');\r\n      opacity: 0.5;\r\n    }\r\n    \r\n    .home-title {\r\n      font-size: var(--font-size-5xl);\r\n      font-weight: 800;\r\n      color: var(--neutral-900);\r\n      margin-bottom: var(--space-4);\r\n      line-height: 1.1;\r\n      position: relative;\r\n      z-index: 1;\r\n    }\r\n    \r\n    .home-subtitle {\r\n      font-size: var(--font-size-xl);\r\n      color: var(--neutral-600);\r\n      margin-bottom: var(--space-8);\r\n      max-width: 600px;\r\n      margin-left: auto;\r\n      margin-right: auto;\r\n      position: relative;\r\n      z-index: 1;\r\n    }\r\n    \r\n    /* Stats section */\r\n    .stats-section {\r\n      background: #f5f9fe;\r\n      border-left: 4px solid #2876ff;\r\n      padding: 1.5rem;\r\n      border-radius: 10px;\r\n      margin-bottom: 2.5rem;\r\n    }\r\n    .stats-grid {\r\n      display: grid;\r\n      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\r\n      gap: 1.5rem;\r\n    }\r\n    .stat-item {\r\n      text-align: center;\r\n    }\r\n    .stat-number {\r\n      font-size: 2.2rem;\r\n      font-weight: 700;\r\n      color: #2876ff;\r\n      margin-bottom: 0.3rem;\r\n    }\r\n    .stat-label {\r\n      font-size: 0.95rem;\r\n      color: #6c757d;\r\n      font-weight: 500;\r\n    }\r\n    \r\n    /* Quick actions grid - individual cards */\r\n    .quick-actions {\r\n      display: grid;\r\n      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\r\n      gap: 1.5rem;\r\n      margin-bottom: 2rem;\r\n    }\r\n    .quick-card {\r\n      background: #fff;\r\n      border: 1px solid #e9ecef;\r\n      border-radius: 12px;\r\n      padding: 2rem 1.5rem;\r\n      text-align: center;\r\n      transition: all 0.2s ease;\r\n      box-shadow: 0 2px 8px rgba(0,0,0,0.05);\r\n    }\r\n    .quick-card:hover {\r\n      transform: translateY(-2px);\r\n      box-shadow: 0 4px 16px rgba(40,118,255,0.1);\r\n      border-color: #2876ff;\r\n    }\r\n    .quick-icon {\r\n      font-size: 2.5rem;\r\n      color: #2876ff;\r\n      margin-bottom: 1rem;\r\n    }\r\n    .quick-title {\r\n      font-size: 1.3rem;\r\n      font-weight: 700;\r\n      color: #1d3557;\r\n      margin-bottom: 0.5rem;\r\n    }\r\n    .quick-desc {\r\n      font-size: 1rem;\r\n      color: #6c757d;\r\n      margin-bottom: 1.5rem;\r\n      line-height: 1.5;\r\n    }\r\n    \r\n    /* Custom buttons - consistent with other pages */\r\n    .custom-btn {\r\n      display: inline-block;\r\n      border-radius: 7px;\r\n      padding: 0.62rem 1.4rem;\r\n      font-size: 1.01rem;\r\n      font-weight: 500;\r\n      text-decoration: none;\r\n      border: 1px solid transparent;\r\n      cursor: pointer;\r\n      transition: all 0.16s;\r\n    }\r\n    .custom-btn-primary { \r\n      background: #2876ff; \r\n      color: #fff; \r\n      border: 1px solid #2876ff;\r\n    }\r\n    .custom-btn-primary:hover { \r\n      background: #205bb8; \r\n      border-color: #205bb8; \r\n      transform: translateY(-1px);\r\n    }\r\n    .custom-btn-outline-primary { \r\n      background: none; \r\n      color: #2876ff; \r\n      border: 1px solid #2876ff;\r\n    }\r\n    .custom-btn-outline-primary:hover { \r\n      background: #2876ff; \r\n      color: #fff;\r\n    }\r\n    \r\n    /* Features section - card design */\r\n    .features-section {\r\n      background: #fff;\r\n      border: 1px solid #e9ecef;\r\n      border-radius: 12px;\r\n      padding: 2rem;\r\n      margin-top: 3rem;\r\n      box-shadow: 0 2px 8px rgba(0,0,0,0.05);\r\n    }\r\n    .features-title {\r\n      font-size: 1.5rem;\r\n      font-weight: 700;\r\n      color: #1d3557;\r\n      margin-bottom: 1.5rem;\r\n      text-align: center;\r\n    }\r\n    .features-grid {\r\n      display: grid;\r\n      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\r\n      gap: 1.5rem;\r\n    }\r\n    .feature-item {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 1rem;\r\n    }\r\n    .feature-icon {\r\n      font-size: 1.5rem;\r\n      color: #2876ff;\r\n      flex-shrink: 0;\r\n    }\r\n    .feature-text {\r\n      font-size: 1rem;\r\n      color: #495057;\r\n    }\r\n    \r\n    /* Responsive design */\r\n    @media (max-width: 768px) {\r\n      .home-main { padding: 1.5rem 1rem; margin: 1rem; }\r\n      .home-title { font-size: 2.2rem; }\r\n      .stats-grid { grid-template-columns: repeat(2, 1fr); }\r\n      .quick-actions { grid-template-columns: 1fr; }\r\n      .features-grid { grid-template-columns: 1fr; }\r\n    }\r\n    \r\n    @media (max-width: 480px) {\r\n      .home-title { font-size: 1.8rem; }\r\n      .stats-grid { grid-template-columns: 1fr; }\r\n    }\r\n  </style>\r\n</head>\r\n<body>\r\n  {{ web_block(\"navbar\") }}\r\n{{ web_block(\"toast\") }}\r\n  \r\n<div class=\"home-main\">\r\n    <!-- Hero Section -->\r\n    <div class=\"home-hero\">\r\n      <h1 class=\"home-title\">Library Management System</h1>\r\n      <p class=\"home-subtitle\">\r\n        Discover, explore, and manage your library experience with our comprehensive digital platform.<br>\r\n        Browse articles, track your rentals, and access exclusive member features.\r\n      </p>\r\n    </div>\r\n\r\n    <!-- Stats Section -->\r\n    <div class=\"stats-section\">\r\n      <div class=\"stats-grid\">\r\n        <div class=\"stat-item\">\r\n          <div class=\"stat-number\">1,250+</div>\r\n          <div class=\"stat-label\">Available Articles</div>\r\n        </div>\r\n        <div class=\"stat-item\">\r\n          <div class=\"stat-number\">500+</div>\r\n          <div class=\"stat-label\">Active Members</div>\r\n        </div>\r\n        <div class=\"stat-item\">\r\n          <div class=\"stat-number\">15,000+</div>\r\n          <div class=\"stat-label\">Books Borrowed</div>\r\n        </div>\r\n        <div class=\"stat-item\">\r\n          <div class=\"stat-number\">98%</div>\r\n          <div class=\"stat-label\">Satisfaction Rate</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Quick Actions -->\r\n    <section class=\"quick-actions\">\r\n      <!-- Browse Articles -->\r\n      <div class=\"quick-card\">\r\n        <i class=\"bi bi-journal-bookmark-fill quick-icon\"></i>\r\n        <div class=\"quick-title\">Browse Articles</div>\r\n        <div class=\"quick-desc\">Explore our extensive collection of articles, books, and digital resources. Search by author, publisher, or category.</div>\r\n        <a href=\"/articles-page\" class=\"custom-btn custom-btn-primary\">\r\n          <i class=\"bi bi-search\"></i> Browse Collection\r\n        </a>\r\n      </div>\r\n\r\n      <!-- My Articles -->\r\n      <div class=\"quick-card\">\r\n        <i class=\"bi bi-folder2-open quick-icon\"></i>\r\n        <div class=\"quick-title\">My Articles</div>\r\n        <div class=\"quick-desc\">View and manage your borrowed articles. Track due dates, renew items, and manage your reading list.</div>\r\n        <a href=\"/my-articles\" class=\"custom-btn custom-btn-primary\">\r\n          <i class=\"bi bi-list-check\"></i> My Articles\r\n        </a>\r\n      </div>\r\n\r\n      <!-- Membership -->\r\n      <div class=\"quick-card\">\r\n        <i class=\"bi bi-person-badge-fill quick-icon\"></i>\r\n        <div class=\"quick-title\">Membership</div>\r\n        <div class=\"quick-desc\">Manage your library membership, view account details, and access exclusive member benefits and features.</div>\r\n        <a href=\"/membership\" class=\"custom-btn custom-btn-primary\">\r\n          <i class=\"bi bi-person-gear\"></i> My Membership\r\n        </a>\r\n      </div>\r\n\r\n      <!-- Member Dashboard -->\r\n      <div class=\"quick-card\">\r\n        <i class=\"bi bi-speedometer2 quick-icon\"></i>\r\n        <div class=\"quick-title\">Dashboard</div>\r\n        <div class=\"quick-desc\">Access your personalized dashboard with quick stats, recent activity, and personalized recommendations.</div>\r\n        <a href=\"/my-articles\" class=\"custom-btn custom-btn-outline-primary\">\r\n          <i class=\"bi bi-graph-up\"></i> View Dashboard\r\n        </a>\r\n      </div>\r\n    </section>\r\n\r\n    <!-- Features Section -->\r\n    <div class=\"features-section\">\r\n      <h2 class=\"features-title\">Why Choose Our Library?</h2>\r\n      <div class=\"features-grid\">\r\n        <div class=\"feature-item\">\r\n          <i class=\"bi bi-clock feature-icon\"></i>\r\n          <div class=\"feature-text\">24/7 Digital Access to thousands of articles and books</div>\r\n        </div>\r\n        <div class=\"feature-item\">\r\n          <i class=\"bi bi-shield-check feature-icon\"></i>\r\n          <div class=\"feature-text\">Secure and reliable platform with data protection</div>\r\n        </div>\r\n        <div class=\"feature-item\">\r\n          <i class=\"bi bi-people feature-icon\"></i>\r\n          <div class=\"feature-text\">Community-driven with expert recommendations</div>\r\n        </div>\r\n        <div class=\"feature-item\">\r\n          <i class=\"bi bi-phone feature-icon\"></i>\r\n          <div class=\"feature-text\">Mobile-friendly design for reading anywhere</div>\r\n        </div>\r\n        <div class=\"feature-item\">\r\n          <i class=\"bi bi-bookmark feature-icon\"></i>\r\n          <div class=\"feature-text\">Personal reading lists and favorites</div>\r\n        </div>\r\n        <div class=\"feature-item\">\r\n          <i class=\"bi bi-chat-dots feature-icon\"></i>\r\n          <div class=\"feature-text\">Support team available to help you</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</body>\r\n</html>\r\n",
  "main_section_md": null,
  "meta_description": null,
  "meta_image": null,
  "meta_title": null,
  "modified": "2025-10-28 20:39:57.473426",
  "module": "library_management",
  "name": "home",
  "page_blocks": [],
  "published": 1,
  "route": "home",
  "show_sidebar": 0,
  "show_title": 0,
  "slideshow": null,
  "start_date": null,
  "text_align": "Left",
  "title": "Library Management System",
  "website_sidebar": null
 },
 {
  "breadcrumbs": null,
  "content_type": "HTML",
  "context_script": null,
  "css": null,
  "docstatus": 0,
  "doctype": "Web Page",
  "dynamic_route": 0,
  "dynamic_template": 0,
  "enable_comments": 0,
  "end_date": null,
  "full_width": 1,
  "header": null,
  "insert_style": 0,
  "javascript": null,
  "main_section": null,
  "main_section_html": "<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n  <meta charset=\"UTF-8\" />\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\r\n  <title>Sign Up - Library Management</title>\r\n  <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css\"/>\r\n  <style>\r\n    /* Hide default Frappe navbar */\r\n    .navbar-frappe,\r\n    .navbar-default,\r\n\r\n    .frappe-header,\r\n    .frappe-navbar {\r\n\r\n\r\n      display: none !important;\r\n    }\r\n    \r\n    /* Ensure our custom navbar is visible */\r\n    .custom-navbar,\r\n    .web-block-navbar {\r\n      display: block !important;\r\n    }\r\n    \r\n    /* Override any hiding for our custom navbar */\r\n    .web-block-navbar .navbar,\r\n    .web-block-navbar .navbar-brand,\r\n    .web-block-navbar .navbar-nav {\r\n      display: block !important;\r\n    }\r\n  </style>\r\n</head>\r\n<body>\r\n  {{ web_block(\"navbar\") }}\r\n  {{ web_block(\"toast\") }}\r\n  \r\n<!-- Toast Container -->\r\n<div id=\"toast-container\" style=\"position: fixed; top: 20px; right: 20px; z-index: 9999;\"></div>\r\n\r\n<div class=\"container\" style=\"max-width: 400px; margin: 50px auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);\">\r\n  <h2 style=\"text-align: center; color: #333; margin-bottom: 30px;\">Sign Up</h2>\r\n  \r\n  \r\n  <div id=\"error-message\" style=\"display: none; background-color: #f8d7da; color: #721c24; padding: 10px; border: 1px solid #f5c6cb; border-radius: 4px; margin-bottom: 15px;\"></div>\r\n  \r\n  <div id=\"success-message\" style=\"display: none; background-color: #d4edda; color: #155724; padding: 10px; border: 1px solid #c3e6cb; border-radius: 4px; margin-bottom: 15px;\"></div>\r\n  \r\n  <form id=\"signup-form\" style=\"margin: 0;\">\r\n    <div style=\"margin-bottom: 20px;\">\r\n      <label for=\"full_name\" style=\"display: block; margin-bottom: 5px; font-weight: bold; color: #333;\">Full Name:</label>\r\n      <input type=\"text\" id=\"full_name\" name=\"full_name\" required style=\"width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-size: 16px;\" placeholder=\"Enter your name\">\r\n    </div>\r\n    \r\n    <div style=\"margin-bottom: 20px;\">\r\n      <label for=\"email\" style=\"display: block; margin-bottom: 5px; font-weight: bold; color: #333;\">Email:</label>\r\n      <input type=\"email\" id=\"email\" name=\"email\" required style=\"width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-size: 16px;\" placeholder=\"Enter your email\">\r\n    </div>\r\n    \r\n    <div style=\"margin-bottom: 10px;\">\r\n      <label for=\"password\" style=\"display: block; margin-bottom: 5px; font-weight: bold; color: #333;\">Password:</label>\r\n      <input type=\"password\" id=\"password\" name=\"password\" required minlength=\"6\" style=\"width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-size: 16px;\" placeholder=\"Create a password\">\r\n    </div>\r\n    \r\n    <button type=\"submit\" id=\"submit-btn\" style=\"width: 100%; padding: 12px; background-color: #007bff; color: white; border: none; border-radius: 4px; font-size: 16px; cursor: pointer; margin-bottom: 15px;\">Sign Up</button>\r\n  </form>\r\n  \r\n  <p style=\"text-align: center; margin-top: 10px; font-size: 14px;\">\r\n    Already have an account?\r\n    <a href=\"/login\" style=\"color: #007bff; text-decoration: none;\">Login</a>\r\n  </p>\r\n</div>\r\n\r\n<style>\r\n/* Toast Styles */\r\n.toast {\r\n  position: relative;\r\n  min-width: 300px;\r\n  max-width: 500px;\r\n  margin-bottom: 10px;\r\n  padding: 16px 20px;\r\n  border-radius: 8px;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\r\n  display: flex;\r\n  align-items: center;\r\n  animation: slideIn 0.3s ease-out;\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\r\n}\r\n\r\n.toast-success {\r\n  background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);\r\n  color: #155724;\r\n  border-left: 4px solid #28a745;\r\n}\r\n\r\n.toast-error {\r\n  background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);\r\n  color: #721c24;\r\n  border-left: 4px solid #dc3545;\r\n}\r\n\r\n.toast-info {\r\n  background: linear-gradient(135deg, #d1ecf1 0%, #bee5eb 100%);\r\n  color: #0c5460;\r\n  border-left: 4px solid #17a2b8;\r\n}\r\n\r\n.toast-icon {\r\n  font-size: 20px;\r\n  margin-right: 12px;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.toast-content {\r\n  flex: 1;\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  line-height: 1.4;\r\n}\r\n\r\n.toast-close {\r\n  background: none;\r\n  border: none;\r\n  font-size: 18px;\r\n  color: inherit;\r\n  opacity: 0.7;\r\n  cursor: pointer;\r\n  margin-left: 12px;\r\n  padding: 0;\r\n  width: 24px;\r\n  height: 24px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border-radius: 50%;\r\n  transition: all 0.2s ease;\r\n}\r\n\r\n.toast-close:hover {\r\n  opacity: 1;\r\n  background: rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n@keyframes slideIn {\r\n  from {\r\n    transform: translateX(100%);\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    transform: translateX(0);\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n@keyframes slideOut {\r\n  from {\r\n    transform: translateX(0);\r\n    opacity: 1;\r\n  }\r\n  to {\r\n    transform: translateX(100%);\r\n    opacity: 0;\r\n  }\r\n}\r\n\r\n.toast.slide-out {\r\n  animation: slideOut 0.3s ease-in forwards;\r\n}\r\n</style>\r\n\r\n<script>\r\n// Helper function to get CSRF token\r\nfunction getCookie(name) {\r\n  const value = `; ${document.cookie}`;\r\n  const parts = value.split(`; ${name}=`);\r\n  if (parts.length === 2) return parts.pop().split(';').shift();\r\n}\r\n\r\n// Toast notification system\r\nfunction showToast(message, type = 'info', duration = 5000) {\r\n  const container = document.getElementById('toast-container');\r\n  const toast = document.createElement('div');\r\n  toast.className = `toast toast-${type}`;\r\n  \r\n  const icon = type === 'success' ? '✅' : type === 'error' ? '❌' : 'ℹ️';\r\n  \r\n  toast.innerHTML = `\r\n    <span class=\"toast-icon\">${icon}</span>\r\n    <div class=\"toast-content\">${message}</div>\r\n    <button class=\"toast-close\" onclick=\"removeToast(this.parentElement)\">&times;</button>\r\n  `;\r\n  \r\n  container.appendChild(toast);\r\n  \r\n  // Auto remove after duration\r\n  setTimeout(() => {\r\n    if (toast.parentElement) {\r\n      removeToast(toast);\r\n    }\r\n  }, duration);\r\n  \r\n  return toast;\r\n}\r\n\r\nfunction removeToast(toast) {\r\n  toast.classList.add('slide-out');\r\n  setTimeout(() => {\r\n    if (toast.parentElement) {\r\n      toast.parentElement.removeChild(toast);\r\n    }\r\n  }, 300);\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n  const form = document.getElementById('signup-form');\r\n  const errorMsg = document.getElementById('error-message');\r\n  const successMsg = document.getElementById('success-message');\r\n  const submitBtn = document.getElementById('submit-btn');\r\n  \r\n  form.addEventListener('submit', function(e) {\r\n    e.preventDefault();\r\n    \r\n    errorMsg.style.display = 'none';\r\n    successMsg.style.display = 'none';\r\n    \r\n    const formData = {\r\n      email: document.getElementById('email').value.trim(),\r\n      full_name: document.getElementById('full_name').value.trim(),\r\n      password: document.getElementById('password').value,\r\n      redirect_to: '/'\r\n    };\r\n    \r\n    submitBtn.disabled = true;\r\n    submitBtn.textContent = 'Signing up...';\r\n    \r\n    // Use fetch API instead of frappe.call\r\n    console.log('🔍 DEBUG: Signup form data:', formData);\r\n    console.log('🔍 DEBUG: Making API call to signup');\r\n    \r\n    fetch('/api/method/library_management.api.signup', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'X-Frappe-CSRF-Token': getCookie('csrf_token') || '{{ frappe.session.csrf_token }}'\r\n      },\r\n      body: JSON.stringify(formData)\r\n    })\r\n    .then(response => {\r\n      console.log('🔍 DEBUG: Signup API response status:', response.status);\r\n      return response.json();\r\n    })\r\n    .then(data => {\r\n      console.log('🔍 DEBUG: Signup API response data:', data);\r\n      \r\n      // Handle different response structures\r\n      let resp = {};\r\n      if (data.message) {\r\n        resp = data.message;\r\n      } else if (data) {\r\n        resp = data;\r\n      }\r\n      \r\n      console.log('🔍 DEBUG: Processed response:', resp);\r\n      \r\n      // Check if signup was actually successful\r\n      if (resp.success === true) {\r\n        showToast('Account created successfully! You are now logged in.', 'success', 3000);\r\n        form.reset();\r\n        \r\n        // Redirect after successful signup\r\n        setTimeout(function() {\r\n          window.location.href = resp.redirect_url || '/home';\r\n        }, 2000);\r\n      } else {\r\n        // Show error message from API\r\n        const errorMsg = resp.message || 'Signup failed. Please try again.';\r\n        console.log('🔍 DEBUG: Showing error:', errorMsg);\r\n        showToast(errorMsg, 'error', 6000);\r\n      }\r\n    })\r\n    .catch(error => {\r\n      showToast('An error occurred. Please try again.', 'error', 6000);\r\n      console.error('🔍 DEBUG: Signup error:', error);\r\n    })\r\n    .finally(() => {\r\n      submitBtn.disabled = false;\r\n      submitBtn.textContent = 'Sign Up';\r\n    });\r\n  });\r\n});\r\n</script>",
  "main_section_md": null,
  "meta_description": null,
  "meta_image": null,
  "meta_title": null,
  "modified": "2025-10-28 20:39:57.473426",
  "module": "library_management",
  "name": "signup",
  "page_blocks": [],
  "published": 1,
  "route": "signup",
  "show_sidebar": 0,
  "show_title": 0,
  "slideshow": null,
  "start_date": null,
  "text_align": "Left",
  "title": "Sign Up",
  "website_sidebar": null
 },
 {
  "breadcrumbs": null,
  "content_type": "HTML",
  "context_script": null,
  "css": null,
  "docstatus": 0,
  "doctype": "Web Page",
  "dynamic_route": 0,
  "dynamic_template": 0,
  "enable_comments": 0,
  "end_date": null,
  "full_width": 1,
  "header": null,
  "insert_style": 0,
  "javascript": null,
  "main_section": null,
  "main_section_html": "<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n  <meta charset=\"UTF-8\" />\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\r\n  <title>Login - Library Management</title>\r\n  <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css\"/>\r\n  <style>\r\n    /* Hide default Frappe navbar */\r\n    .navbar-frappe,\r\n    .navbar-default,\r\n\r\n    .frappe-header,\r\n    .frappe-navbar {\r\n\r\n\r\n      display: none !important;\r\n    }\r\n    \r\n    /* Ensure our custom navbar is visible */\r\n    .custom-navbar,\r\n    .web-block-navbar {\r\n      display: block !important;\r\n    }\r\n    \r\n    /* Override any hiding for our custom navbar */\r\n    .web-block-navbar .navbar,\r\n    .web-block-navbar .navbar-brand,\r\n    .web-block-navbar .navbar-nav {\r\n      display: block !important;\r\n    }\r\n  </style>\r\n</head>\r\n<body>\r\n  {{ web_block(\"navbar\") }}\r\n  {{ web_block(\"toast\") }}\r\n  \r\n<div class=\"container\" style=\"max-width: 400px; margin: 50px auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);\">\r\n  <h2 style=\"text-align: center; color: #333; margin-bottom: 30px;\">Login</h2>\r\n  \r\n  <!-- Toast Container -->\r\n  <div id=\"toast-container\" style=\"position: fixed; top: 20px; right: 20px; z-index: 9999;\"></div>\r\n  \r\n  <div id=\"error-message\" style=\"display: none; background-color: #f8d7da; color: #721c24; padding: 10px; border: 1px solid #f5c6cb; border-radius: 4px; margin-bottom: 15px;\"></div>\r\n  \r\n  <div id=\"success-message\" style=\"display: none; background-color: #d4edda; color: #155724; padding: 10px; border: 1px solid #c3e6cb; border-radius: 4px; margin-bottom: 15px;\"></div>\r\n  \r\n  <form id=\"login-form\" style=\"margin: 0;\">\r\n    \r\n    <div style=\"margin-bottom: 20px;\">\r\n      <label for=\"email\" style=\"display: block; margin-bottom: 5px; font-weight: bold; color: #333;\">Email:</label>\r\n      <input type=\"email\" id=\"email\" name=\"email\" required style=\"width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-size: 16px;\" placeholder=\"Enter your email\">\r\n    </div>\r\n    \r\n    <div style=\"margin-bottom: 10px;\">\r\n      <label for=\"password\" style=\"display: block; margin-bottom: 5px; font-weight: bold; color: #333;\">Password:</label>\r\n      <input type=\"password\" id=\"password\" name=\"password\" required style=\"width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-size: 16px;\" placeholder=\"Enter your password\">\r\n    </div>\r\n    \r\n    <div style=\"text-align: right; margin-bottom: 20px;\">\r\n      <a href=\"/forgot-password\" style=\"color: #007bff; text-decoration: none; font-size: 14px;\">Forgot Password?</a>\r\n    </div>\r\n    \r\n    <button type=\"submit\" id=\"login-btn\" style=\"width: 100%; padding: 12px; background-color: #007bff; color: white; border: none; border-radius: 4px; font-size: 16px; cursor: pointer; margin-bottom: 15px;\">Login</button>\r\n  </form>\r\n  \r\n  <div style=\"text-align: center;\"></div>\r\n</div>\r\n\r\n<style>\r\n/* Toast Styles */\r\n.toast {\r\n  position: relative;\r\n  min-width: 300px;\r\n  max-width: 500px;\r\n  margin-bottom: 10px;\r\n  padding: 16px 20px;\r\n  border-radius: 8px;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\r\n  display: flex;\r\n  align-items: center;\r\n  animation: slideIn 0.3s ease-out;\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\r\n}\r\n\r\n.toast-success {\r\n  background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);\r\n  color: #155724;\r\n  border-left: 4px solid #28a745;\r\n}\r\n\r\n.toast-error {\r\n  background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);\r\n  color: #721c24;\r\n  border-left: 4px solid #dc3545;\r\n}\r\n\r\n.toast-info {\r\n  background: linear-gradient(135deg, #d1ecf1 0%, #bee5eb 100%);\r\n  color: #0c5460;\r\n  border-left: 4px solid #17a2b8;\r\n}\r\n\r\n.toast-icon {\r\n  font-size: 20px;\r\n  margin-right: 12px;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.toast-content {\r\n  flex: 1;\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  line-height: 1.4;\r\n}\r\n\r\n.toast-close {\r\n  background: none;\r\n  border: none;\r\n  font-size: 18px;\r\n  color: inherit;\r\n  opacity: 0.7;\r\n  cursor: pointer;\r\n  margin-left: 12px;\r\n  padding: 0;\r\n  width: 24px;\r\n  height: 24px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border-radius: 50%;\r\n  transition: all 0.2s ease;\r\n}\r\n\r\n.toast-close:hover {\r\n  opacity: 1;\r\n  background: rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n@keyframes slideIn {\r\n  from {\r\n    transform: translateX(100%);\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    transform: translateX(0);\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n@keyframes slideOut {\r\n  from {\r\n    transform: translateX(0);\r\n    opacity: 1;\r\n  }\r\n  to {\r\n    transform: translateX(100%);\r\n    opacity: 0;\r\n  }\r\n}\r\n\r\n.toast.slide-out {\r\n  animation: slideOut 0.3s ease-in forwards;\r\n}\r\n</style>\r\n\r\n<script>\r\n// Helper function to get CSRF token\r\nfunction getCookie(name) {\r\n  const value = `; ${document.cookie}`;\r\n  const parts = value.split(`; ${name}=`);\r\n  if (parts.length === 2) return parts.pop().split(';').shift();\r\n}\r\n\r\n// Toast notification system\r\nfunction showToast(message, type = 'info', duration = 5000) {\r\n  const container = document.getElementById('toast-container');\r\n  const toast = document.createElement('div');\r\n  toast.className = `toast toast-${type}`;\r\n  \r\n  const icon = type === 'success' ? '✅' : type === 'error' ? '❌' : 'ℹ️';\r\n  \r\n  toast.innerHTML = `\r\n    <span class=\"toast-icon\">${icon}</span>\r\n    <div class=\"toast-content\">${message}</div>\r\n    <button class=\"toast-close\" onclick=\"removeToast(this.parentElement)\">&times;</button>\r\n  `;\r\n  \r\n  container.appendChild(toast);\r\n  \r\n  // Auto remove after duration\r\n  setTimeout(() => {\r\n    if (toast.parentElement) {\r\n      removeToast(toast);\r\n    }\r\n  }, duration);\r\n  \r\n  return toast;\r\n}\r\n\r\nfunction removeToast(toast) {\r\n  toast.classList.add('slide-out');\r\n  setTimeout(() => {\r\n    if (toast.parentElement) {\r\n      toast.parentElement.removeChild(toast);\r\n    }\r\n  }, 300);\r\n}\r\n\r\n  const form = document.getElementById('login-form');\r\n  const btn = document.getElementById('login-btn');\r\n  const errorMessage = document.getElementById('error-message');\r\n  const successMessage = document.getElementById('success-message');\r\n\r\n  form.addEventListener('submit', function(e) {\r\n    e.preventDefault();\r\n\r\n    const email = document.getElementById('email').value.trim();\r\n    const password = document.getElementById('password').value;\r\n\r\n    // Hide previous messages\r\n    errorMessage.style.display = 'none';\r\n    successMessage.style.display = 'none';\r\n\r\n    // Basic guard\r\n    if (!email || !password) {\r\n      errorMessage.textContent = 'Please enter your email and password.';\r\n      errorMessage.style.display = 'block';\r\n      return;\r\n    }\r\n\r\n    // Disable button while logging in\r\n    const originalText = btn.textContent;\r\n    btn.disabled = true;\r\n    btn.textContent = 'Signing in...';\r\n\r\n    // Call custom login API\r\n    // Use fetch API instead of frappe.call\r\n    console.log('🔍 DEBUG: Login form data:', { email, password: '***' });\r\n    console.log('🔍 DEBUG: Making API call to login');\r\n    \r\n    fetch('/api/method/library_management.api.login', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'X-Frappe-CSRF-Token': getCookie('csrf_token') || '{{ frappe.session.csrf_token }}'\r\n      },\r\n      body: JSON.stringify({ email, password })\r\n    })\r\n    .then(response => {\r\n      console.log('🔍 DEBUG: Login API response status:', response.status);\r\n      return response.json();\r\n    })\r\n    .then(data => {\r\n      console.log('🔍 DEBUG: Login API response data:', data);\r\n      btn.disabled = false;\r\n      btn.textContent = originalText;\r\n\r\n      const resp = data.message || {};\r\n      if (resp.success) {\r\n        showToast('Login successful! Redirecting...', 'success', 2000);\r\n\r\n        // Redirect web users to homepage (avoid \"No App\" screen)\r\n        setTimeout(function() {\r\n          const next = new URLSearchParams(window.location.search).get('next');\r\n          window.location.href = next || '/home';\r\n        }, 1500);\r\n      } else {\r\n        showToast(resp.message || 'Invalid email or password. Please try again.', 'error', 6000);\r\n      }\r\n    })\r\n    .catch(error => {\r\n      console.error('🔍 DEBUG: Login error:', error);\r\n      btn.disabled = false;\r\n      btn.textContent = originalText;\r\n      showToast('Login failed. Please try again.', 'error', 6000);\r\n    });\r\n  });\r\n</script>",
  "main_section_md": null,
  "meta_description": null,
  "meta_image": null,
  "meta_title": null,
  "modified": "2025-10-28 20:39:57.473426",
  "module": "library_management",
  "name": "login",
  "page_blocks": [],
  "published": 1,
  "route": "login",
  "show_sidebar": 0,
  "show_title": 0,
  "slideshow": null,
  "start_date": null,
  "text_align": "Left",
  "title": "Login",
  "website_sidebar": null
 },
 {
  "breadcrumbs": null,
  "content_type": "HTML",
  "context_script": null,
  "css": null,
  "docstatus": 0,
  "doctype": "Web Page",
  "dynamic_route": 0,
  "dynamic_template": 0,
  "enable_comments": 0,
  "end_date": null,
  "full_width": 1,
  "header": null,
  "insert_style": 0,
  "javascript": null,
  "main_section": null,
  "main_section_html": "<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n  <meta charset=\"UTF-8\" />\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\r\n  <title>Articles</title>\r\n  <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" />\r\n  <style>\r\n    /* Hide default Frappe navbar */\r\n    .navbar-frappe,\r\n    .navbar-default,\r\n\r\n    .frappe-header,\r\n    .frappe-navbar {\r\n\r\n\r\n      display: none !important;\r\n    }\r\n    \r\n    /* Ensure our custom navbar is visible */\r\n    .custom-navbar,\r\n    .web-block-navbar {\r\n      display: block !important;\r\n    }\r\n    \r\n    /* Override any hiding for our custom navbar */\r\n    .web-block-navbar .navbar,\r\n    .web-block-navbar .navbar-brand,\r\n    .web-block-navbar .navbar-nav {\r\n      display: block !important;\r\n    }\r\n    \r\n    .articles-page {\r\n      padding: 2rem;\r\n      max-width: 1200px;\r\n      margin: 0 auto;\r\n    }\r\n    .page-header {\r\n      text-align: center;\r\n      margin-bottom: 2rem;\r\n    }\r\n    .page-header h1 {\r\n      font-size: 2.5rem;\r\n      margin-bottom: 0.5rem;\r\n      font-weight: 700;\r\n      color: #222;\r\n      letter-spacing: -1px;\r\n    }\r\n    .article-summary {\r\n      font-size: 1.1rem;\r\n      color: #6c757d;\r\n    }\r\n    .articles-grid {\r\n      display: grid;\r\n      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));\r\n      gap: 2rem;\r\n      margin: 0;\r\n      padding: 0;\r\n      width: 100%;\r\n    }\r\n    .article-card {\r\n      position: relative;\r\n      display: flex;\r\n      flex-direction: column;\r\n      min-width: 0;\r\n      border: 1px solid #e3e5ea;\r\n      border-radius: 1rem;\r\n      background: #fff;\r\n      box-shadow: 0 4px 24px rgba(0,0,0,0.08);\r\n      transition: transform 0.2s, box-shadow 0.2s;\r\n      margin: 0;\r\n    }\r\n    .article-card:hover {\r\n      transform: translateY(-3px) scale(1.01);\r\n      box-shadow: 0 8px 32px rgba(0,0,0,0.12);\r\n    }\r\n    \r\n    .article-card:hover .card-img-top {\r\n      transform: scale(1.05);\r\n    }\r\n    \r\n    .card-img-top-holder {\r\n      overflow: hidden;\r\n    }\r\n    .card-body {\r\n      flex: 1 1 auto;\r\n      padding: 1.5rem;\r\n      display: flex;\r\n      flex-direction: column;\r\n    }\r\n    .card-title {\r\n      font-size: 1.38rem;\r\n      margin-bottom: 0.5rem;\r\n      color: #333;\r\n      font-weight: 700;\r\n      line-height: 1.25;\r\n      letter-spacing: -0.5px;\r\n    }\r\n    .card-subtitle {\r\n      font-size: 1rem;\r\n      margin-bottom: 0.5rem;\r\n      color: #6c757d;\r\n      font-weight: 400;\r\n    }\r\n    .card-text {\r\n      font-size: 0.99rem;\r\n      color: #495057;\r\n      margin-bottom: 1rem;\r\n      line-height: 1.53;\r\n    }\r\n    .article-meta {\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n      justify-content: space-between;\r\n      align-items: center;\r\n      margin-top: 1rem;\r\n      gap: 0.5rem;\r\n    }\r\n    .badge {\r\n      display: inline-block;\r\n      padding: 0.32em 1.0em;\r\n      font-size: 0.97em;\r\n      font-weight: 600;\r\n      border-radius: 1em;\r\n      text-align: center;\r\n      color: #fff;\r\n    }\r\n    .badge-success {\r\n      background-color: #2876ff;\r\n    }\r\n    .badge-secondary {\r\n      background-color: #adb5bd;\r\n    }\r\n    .btn {\r\n      display: inline-block;\r\n      font-weight: 500;\r\n      text-align: center;\r\n      vertical-align: middle;\r\n      cursor: pointer;\r\n      border: 1px solid transparent;\r\n      padding: 0.46rem 1.1rem;\r\n      font-size: 0.99rem;\r\n      line-height: 1.5;\r\n      border-radius: 0.38rem;\r\n      text-decoration: none;\r\n      transition: all 0.2s;\r\n      margin-top: 0.2rem;\r\n    }\r\n    .btn-primary {\r\n      color: #fff;\r\n      background-color: #2876ff;\r\n      border-color: #2876ff;\r\n    }\r\n    .btn-primary:hover {\r\n      background-color: #205bb8;\r\n      border-color: #205bb8;\r\n    }\r\n    .btn-outline-secondary {\r\n      color: #6c757d;\r\n      border-color: #d3d8e0;\r\n      background-color: transparent;\r\n    }\r\n    .btn-outline-secondary:hover {\r\n      color: #fff;\r\n      background-color: #6c757d;\r\n      border-color: #6c757d;\r\n    }\r\n    .btn-sm {\r\n      padding: 0.4rem 0.9rem;\r\n      font-size: 0.95rem;\r\n      border-radius: 0.32rem;\r\n    }\r\n    .alert {\r\n      position: relative;\r\n      padding: 0.85rem 1.25rem;\r\n      margin-bottom: 1.2rem;\r\n      border: 1px solid transparent;\r\n      border-radius: 0.38rem;\r\n      font-size: 1rem;\r\n    }\r\n    .alert-info {\r\n      color: #1c7382;\r\n      background-color: #e6f6fa;\r\n      border-color: #bee5eb;\r\n    }\r\n    .alert-danger {\r\n      color: #721c24;\r\n      background-color: #f8d7da;\r\n      border-color: #f5c6cb;\r\n    }\r\n    .spinner-border {\r\n      display: inline-block;\r\n      width: 2rem;\r\n      height: 2rem;\r\n      vertical-align: text-bottom;\r\n      border: 0.25em solid currentColor;\r\n      border-right-color: transparent;\r\n      border-radius: 50%;\r\n      animation: spinner-border 0.75s linear infinite;\r\n    }\r\n    @keyframes spinner-border { to { transform: rotate(360deg); } }\r\n    .text-center { text-align: center; }\r\n    .sr-only {\r\n      position: absolute;\r\n      width: 1px;\r\n      height: 1px;\r\n      padding: 0;\r\n      margin: -1px;\r\n      overflow: hidden;\r\n      clip: rect(0, 0, 0, 0);\r\n      white-space: nowrap;\r\n      border: 0;\r\n    }\r\n    .text-muted { color: #6c757d !important; }\r\n    .mt-3 { margin-top: 1rem; }\r\n    .ml-2 { margin-left: 0.5rem; }\r\n    @media (max-width: 768px) {\r\n      .articles-grid { grid-template-columns: 1fr; gap: 1rem; }\r\n      .articles-page { padding: 1rem; }\r\n      .page-header h1 { font-size: 2rem; }\r\n    }\r\n    @media (min-width: 769px) and (max-width: 1024px) {\r\n      .articles-grid { grid-template-columns: repeat(2, 1fr); }\r\n    }\r\n    @media (min-width: 1025px) {\r\n      .articles-grid { grid-template-columns: repeat(3, 1fr); }\r\n    }\r\n  </style>\r\n</head>\r\n<body>\r\n  {{ web_block(\"navbar\") }}\r\n{{ web_block(\"toast\") }}\r\n  \r\n  <div class=\"articles-page\">\r\n    <header class=\"page-header\">\r\n      <h1>Articles</h1>\r\n      <p class=\"article-summary\">Browse our collection of articles.</p>\r\n    </header>\r\n    <section class=\"articles-list\" aria-label=\"Articles\">\r\n      <div id=\"loading-spinner\" class=\"text-center\" style=\"display: none;\">\r\n        <div class=\"spinner-border\" role=\"status\">\r\n          <span class=\"sr-only\">Loading...</span>\r\n        </div>\r\n        <p>Loading articles...</p>\r\n      </div>\r\n\r\n      <div id=\"articles-container\" class=\"articles-grid\">\r\n        <!-- Articles will be loaded here dynamically -->\r\n      </div>\r\n\r\n      <div id=\"no-articles\" class=\"alert alert-info\" style=\"display: none;\">\r\n        <p>No articles found. <a href=\"/app/article/new\">Create your first article</a></p>\r\n      </div>\r\n\r\n      <div id=\"error-message\" class=\"alert alert-danger\" style=\"display: none;\">\r\n        <p>Error loading articles. Please try again later.</p>\r\n      </div>\r\n    </section>\r\n  </div>\r\n  <script>\r\n    // Helper function to get CSRF token\r\n    function getCookie(name) {\r\n      const value = `; ${document.cookie}`;\r\n      const parts = value.split(`; ${name}=`);\r\n      if (parts.length === 2) return parts.pop().split(';').shift();\r\n    }\r\n    \r\n    document.addEventListener('DOMContentLoaded', function() { \r\n      console.log('🔍 DEBUG: Articles page loaded, starting loadArticles()');\r\n      loadArticles(); \r\n    });\r\n    \r\n    function loadArticles() {\r\n      console.log('🔍 DEBUG: Starting loadArticles()');\r\n      document.getElementById('loading-spinner').style.display = 'block';\r\n      document.getElementById('articles-container').style.display = 'none';\r\n      document.getElementById('no-articles').style.display = 'none';\r\n      document.getElementById('error-message').style.display = 'none';\r\n      \r\n      console.log('🔍 DEBUG: Making API call to get_articles');\r\n      \r\n      // Use fetch API instead of frappe.call\r\n      fetch('/api/method/library_management.api.get_articles', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'X-Frappe-CSRF-Token': getCookie('csrf_token') || '{{ frappe.session.csrf_token }}'\r\n        }\r\n      })\r\n      .then(response => response.json())\r\n      .then(data => {\r\n        console.log('🔍 DEBUG: API response received:', data);\r\n        document.getElementById('loading-spinner').style.display = 'none';\r\n        \r\n        if (data.message && data.message.success) {\r\n          const articles = data.message.articles;\r\n          console.log('🔍 DEBUG: Articles data:', articles);\r\n          if (articles && articles.length > 0) {\r\n            displayArticles(articles);\r\n          } else {\r\n            showNoArticles();\r\n          }\r\n        } else {\r\n          console.error('🔍 DEBUG: API error:', data.message);\r\n          showError('Error loading articles: ' + (data.message ? data.message.message : 'Unknown error'));\r\n        }\r\n      })\r\n      .catch(error => {\r\n        console.error('🔍 DEBUG: Network error:', error);\r\n        document.getElementById('loading-spinner').style.display = 'none';\r\n        showError('Network error loading articles. Please check your connection.');\r\n      });\r\n    }\r\n    function displayArticles(articles) {\r\n      const container = document.getElementById('articles-container');\r\n      container.innerHTML = '';\r\n      container.style.display = 'grid';\r\n      articles.forEach(article => {\r\n        const articleCard = createArticleCard(article);\r\n        container.appendChild(articleCard);\r\n      });\r\n    }\r\n    function createArticleCard(article) {\r\n      const cardDiv = document.createElement('div');\r\n      cardDiv.className = 'card article-card';\r\n\r\n      // Add image if available\r\n      if (article.image) {\r\n        const imgDiv = document.createElement('div');\r\n        imgDiv.className = 'card-img-top-holder';\r\n        imgDiv.style.cssText = 'height: 200px; overflow: hidden; position: relative;';\r\n        \r\n        const img = document.createElement('img');\r\n        img.src = article.image;\r\n        img.alt = (article.title || article.name) + ' - Article image';\r\n        img.className = 'card-img-top';\r\n        img.style.cssText = 'width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease;';\r\n        img.onerror = function() {\r\n          this.style.display = 'none';\r\n          const placeholder = document.createElement('div');\r\n          placeholder.style.cssText = 'width: 100%; height: 100%; background: #f8f9fa; display: flex; align-items: center; justify-content: center; color: #6c757d;';\r\n          placeholder.innerHTML = '<i class=\"bi bi-image\" style=\"font-size: 2rem;\"></i>';\r\n          imgDiv.appendChild(placeholder);\r\n        };\r\n        \r\n        imgDiv.appendChild(img);\r\n        cardDiv.appendChild(imgDiv);\r\n      } else {\r\n        // Add placeholder for articles without images\r\n        const placeholderDiv = document.createElement('div');\r\n        placeholderDiv.className = 'card-img-top-holder';\r\n        placeholderDiv.style.cssText = 'height: 200px; background: #f8f9fa; display: flex; align-items: center; justify-content: center; color: #6c757d;';\r\n        placeholderDiv.innerHTML = '<i class=\"bi bi-book\" style=\"font-size: 3rem;\"></i>';\r\n        cardDiv.appendChild(placeholderDiv);\r\n      }\r\n\r\n      const cardBody = document.createElement('div');\r\n      cardBody.className = 'card-body';\r\n\r\n      // Title\r\n      const title = document.createElement('h3');\r\n      title.className = 'card-title';\r\n      title.textContent = article.title || article.name;\r\n      cardBody.appendChild(title);\r\n\r\n      // Author\r\n      if (article.author) {\r\n        const author = document.createElement('p');\r\n        author.className = 'card-subtitle text-muted';\r\n        author.textContent = 'By ' + article.author;\r\n        cardBody.appendChild(author);\r\n      }\r\n\r\n      // Publisher\r\n      if (article.publisher) {\r\n        const publisher = document.createElement('p');\r\n        publisher.className = 'card-subtitle text-muted';\r\n        publisher.textContent = 'Published by ' + article.publisher;\r\n        cardBody.appendChild(publisher);\r\n      }\r\n\r\n      // Description\r\n      if (article.description) {\r\n        const description = document.createElement('p');\r\n        description.className = 'card-text';\r\n        description.textContent = article.description_preview || article.description;\r\n        cardBody.appendChild(description);\r\n      }\r\n\r\n      // Meta information\r\n      const metaDiv = document.createElement('div');\r\n      metaDiv.className = 'article-meta';\r\n\r\n      // Status badge\r\n      if (article.status) {\r\n        const statusBadge = document.createElement('span');\r\n        statusBadge.className = 'badge badge-' + (article.status === 'Available' ? 'success' : 'secondary');\r\n        statusBadge.textContent = article.status;\r\n        metaDiv.appendChild(statusBadge);\r\n      }\r\n\r\n      // ISBN\r\n      if (article.isbn) {\r\n        const isbn = document.createElement('small');\r\n        isbn.className = 'text-muted';\r\n        isbn.textContent = 'ISBN: ' + article.isbn;\r\n        metaDiv.appendChild(isbn);\r\n      }\r\n\r\n      // Creation date\r\n      const date = document.createElement('small');\r\n      date.className = 'text-muted';\r\n      date.textContent = article.formatted_date;\r\n      metaDiv.appendChild(date);\r\n\r\n      cardBody.appendChild(metaDiv);\r\n\r\n      // Action buttons\r\n      const actionsDiv = document.createElement('div');\r\n      actionsDiv.className = 'mt-3';\r\n\r\n      // View Details button\r\n      const viewBtn = document.createElement('a');\r\n      viewBtn.href = '/article-detail?article_name=' + article.name;\r\n      viewBtn.className = 'btn btn-sm btn-primary';\r\n      viewBtn.textContent = 'View Details';\r\n      actionsDiv.appendChild(viewBtn);\r\n\r\n      // Rent Article button (only for logged-in users)\r\n      // Check if user is logged in by looking for session data in the page\r\n      const isLoggedIn = document.cookie.includes('sid=') || document.cookie.includes('user_id=');\r\n      if (isLoggedIn) {\r\n        const rentBtn = document.createElement('a');\r\n        rentBtn.href = '/article-detail?article_name=' + article.name;\r\n        rentBtn.className = 'btn btn-sm btn-outline-secondary ml-2';\r\n        rentBtn.textContent = 'Rent Article';\r\n        actionsDiv.appendChild(rentBtn);\r\n      }\r\n\r\n      cardBody.appendChild(actionsDiv);\r\n      cardDiv.appendChild(cardBody);\r\n\r\n      return cardDiv;\r\n    }\r\n    function showNoArticles() {\r\n      document.getElementById('no-articles').style.display = 'block';\r\n      document.getElementById('articles-container').style.display = 'none';\r\n    }\r\n    function showError(message) {\r\n      const errorDiv = document.getElementById('error-message');\r\n      errorDiv.querySelector('p').textContent = message;\r\n      errorDiv.style.display = 'block';\r\n      document.getElementById('articles-container').style.display = 'none';\r\n    }\r\n  </script>\r\n</body>\r\n</html>",
  "main_section_md": null,
  "meta_description": null,
  "meta_image": null,
  "meta_title": null,
  "modified": "2025-10-28 20:39:57.473426",
  "module": "library_management",
  "name": "articles-page",
  "page_blocks": [],
  "published": 1,
  "route": "articles-page",
  "show_sidebar": 0,
  "show_title": 0,
  "slideshow": null,
  "start_date": null,
  "text_align": "Left",
  "title": "Articles",
  "website_sidebar": null
 },
 {
  "breadcrumbs": null,
  "content_type": "HTML",
  "context_script": null,
  "css": null,
  "docstatus": 0,
  "doctype": "Web Page",
  "dynamic_route": 0,
  "dynamic_template": 0,
  "enable_comments": 0,
  "end_date": null,
  "full_width": 1,
  "header": null,
  "insert_style": 0,
  "javascript": null,
  "main_section": null,
  "main_section_html": "<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n  <meta charset=\"UTF-8\" />\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\r\n  <title>Article Detail - Library Management</title>\r\n  <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css\"/>\r\n  <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css\"/>\r\n  {{ web_block(\"design-system\") }}\r\n  <style>\r\n    /* Hide default Frappe navbar */\r\n    .navbar-frappe,\r\n    .navbar-default,\r\n\r\n    .frappe-header,\r\n    .frappe-navbar {\r\n\r\n\r\n      display: none !important;\r\n    }\r\n    \r\n    /* Ensure our custom navbar is visible */\r\n    .custom-navbar,\r\n    .web-block-navbar {\r\n      display: block !important;\r\n    }\r\n    \r\n    /* Override any hiding for our custom navbar */\r\n    .web-block-navbar .navbar,\r\n    .web-block-navbar .navbar-brand,\r\n    .web-block-navbar .navbar-nav {\r\n      display: block !important;\r\n    }\r\n  </style>\r\n</head>\r\n<body>\r\n  {{ web_block(\"navbar\") }}\r\n  {{ web_block(\"toast\") }}\r\n  \r\n  <div class=\"container mt-5\">\r\n    <h1>Article Detail</h1>\r\n    <div class=\"row\">\r\n      <div class=\"col-md-12\">\r\n        <div class=\"card\">\r\n          <div class=\"card-body\">\r\n            <h5 class=\"card-title\">Article Details</h5>\r\n            <p class=\"card-text\">View detailed information about this article.</p>\r\n            <a href=\"/articles-page\" class=\"btn btn-primary\">Back to Articles</a>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</body>\r\n</html>",
  "main_section_md": null,
  "meta_description": null,
  "meta_image": null,
  "meta_title": null,
  "modified": "2025-10-28 20:39:57.473426",
  "module": "library_management",
  "name": "article-detail",
  "page_blocks": [],
  "published": 1,
  "route": "article-detail",
  "show_sidebar": 0,
  "show_title": 0,
  "slideshow": null,
  "start_date": null,
  "text_align": "Left",
  "title": "Article Detail",
  "website_sidebar": null
 },
 {
  "breadcrumbs": null,
  "content_type": "HTML",
  "context_script": null,
  "css": null,
  "docstatus": 0,
  "doctype": "Web Page",
  "dynamic_route": 0,
  "dynamic_template": 0,
  "enable_comments": 0,
  "end_date": null,
  "full_width": 1,
  "header": null,
  "insert_style": 0,
  "javascript": null,
  "main_section": null,
  "main_section_html": "<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n  <meta charset=\"UTF-8\" />\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\r\n  <title>Library Membership</title>\r\n  <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" />\r\n  <style>\r\n    /* Hide default Frappe navbar */\r\n    .navbar-frappe,\r\n    .navbar-default,\r\n\r\n    .frappe-header,\r\n    .frappe-navbar {\r\n\r\n\r\n      display: none !important;\r\n    }\r\n    \r\n    /* Ensure our custom navbar is visible */\r\n    .custom-navbar,\r\n    .web-block-navbar {\r\n      display: block !important;\r\n    }\r\n    \r\n    /* Override any hiding for our custom navbar */\r\n    .web-block-navbar .navbar,\r\n    .web-block-navbar .navbar-brand,\r\n    .web-block-navbar .navbar-nav {\r\n      display: block !important;\r\n    }\r\n    \r\n    body {background: #f9f9fb; font-family: system-ui, 'Segoe UI', Arial, sans-serif;}\r\n    .membership-page {padding: 2rem; max-width: 900px; margin: 0 auto;}\r\n    .page-header {text-align: center; margin-bottom: 2rem;}\r\n    .page-header h1 {font-size: 2.5rem; margin-bottom: 0.5rem; font-weight: 700; color: #222;}\r\n    .membership-summary {font-size: 1.1rem; color: #6c757d;}\r\n    .membership-list {margin-top: 0;}\r\n    .membership-grid {display: grid; grid-template-columns: 1fr; gap: 2rem; width: 100%;}\r\n    .membership-card {width: 100%; border: 1px solid #e3e5ea; border-radius: 1rem; background: #fff; box-shadow: 0 4px 24px rgba(0,0,0,0.08); display: flex; flex-direction: column; min-width: 0; padding-bottom: 0.5rem;}\r\n    .membership-card:hover {transform: translateY(-3px) scale(1.01); box-shadow: 0 8px 32px rgba(0,0,0,0.12);}\r\n    .card-header {padding: 1.1rem 1.5rem 0.4rem 1.5rem; border-bottom: 1px solid #f2f3f6; background: none;}\r\n    .card-header h4 {font-size: 1.25rem; font-weight: 600; color: #283048;}\r\n    .card-body {padding: 1.2rem 1.5rem 1rem 1.5rem;}\r\n    .status-badge {display: inline-block; padding: 0.3em 1.2em; font-size: 1rem; font-weight: 600; border-radius: 1.2em; color: #fff; background: #2876ff;}\r\n    .status-badge.expired {background: #adb5bd;}\r\n    .membership-item {font-size:1rem; color: #495057; margin-bottom: 0.3em;}\r\n    .divider {height: 1px; margin: 1.1em 0; background: #f0f1f4; border: none;}\r\n    .alert {position: relative; padding: 0.85rem 1.25rem; margin-bottom: 1.2rem; border: 1px solid transparent; border-radius: 0.38rem; font-size: 1rem;}\r\n    .alert-info {color: #1c7382; background-color: #e6f6fa; border-color: #bee5eb;}\r\n    .alert-success {color: #167c25; background-color: #d4edda; border-color: #c3e6cb;}\r\n    .alert-danger {color: #721c24; background-color: #f8d7da; border-color: #f5c6cb;}\r\n    @media (max-width: 600px) {.membership-page {padding: 1rem; max-width: 100%;} .membership-grid {gap: 1rem; grid-template-columns: 1fr;} .page-header h1 {font-size: 1.3rem;}}\r\n  </style>\r\n</head>\r\n<body>\r\n  {{ web_block(\"navbar\") }}\r\n{{ web_block(\"toast\") }}\r\n  \r\n<div class=\"membership-page\">\r\n    <header class=\"page-header\">\r\n      <h1>Library Membership</h1>\r\n      <p class=\"membership-summary\">Join our library community and access thousands of books.</p>\r\n    </header>\r\n    <section class=\"membership-list\" aria-label=\"Membership\">\r\n      <div id=\"membership-grid\" class=\"membership-grid\"></div>\r\n      <div id=\"message-container\" class=\"mt-3\"></div>\r\n    </section>\r\n  </div>\r\n  <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js\"></script>\r\n  <script src=\"https://code.jquery.com/jquery-3.6.0.min.js\"></script>\r\n  <script>\r\n    // Helper function to get CSRF token\r\n    function getCookie(name) {\r\n      const value = `; ${document.cookie}`;\r\n      const parts = value.split(`; ${name}=`);\r\n      if (parts.length === 2) return parts.pop().split(';').shift();\r\n    }\r\n    \r\n    let membershipData = null;\r\n    let isLoggedIn = false;\r\n\r\n    function checkLoginStatus() {\r\n      // Check if user is logged in by looking for session data in cookies\r\n      return document.cookie.includes('sid=') || document.cookie.includes('user_id=');\r\n    }\r\n\r\n    $(document).ready(function() {\r\n      isLoggedIn = checkLoginStatus();\r\n      if (!isLoggedIn) {\r\n        showLoginMessage();\r\n        return;\r\n      }\r\n      loadMembershipStatus();\r\n    });\r\n\r\n    function showLoginMessage() {\r\n      const html = `\r\n        <div class=\"card membership-card mb-3\">\r\n          <div class=\"card-body text-center\">\r\n            <div class=\"alert alert-info mb-0\">\r\n              <h5 class=\"h6\">Login Required</h5>\r\n              <p class=\"mb-3\">Please log in to view your membership status and join the library.</p>\r\n              <a href=\"/login\" class=\"btn btn-primary btn-sm\">Login</a>\r\n              <a href=\"/signup\" class=\"btn btn-outline-secondary btn-sm ms-2\">Sign Up</a>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      `;\r\n      $('#membership-grid').html(html);\r\n    }\r\n\r\n    function loadMembershipStatus() {\r\n      // Use fetch API instead of frappe.call\r\n      fetch('/api/method/library_management.api.get_membership_status', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'X-Frappe-CSRF-Token': getCookie('csrf_token') || '{{ frappe.session.csrf_token }}'\r\n        }\r\n      })\r\n      .then(response => response.json())\r\n      .then(data => {\r\n        if (data.message && data.message.success) {\r\n          membershipData = data.message;\r\n          displayMembershipCards();\r\n        } else {\r\n          showError('Error loading membership status.');\r\n        }\r\n      })\r\n      .catch(error => {\r\n        showError('Error loading membership status.');\r\n        console.error('Error loading membership status:', error);\r\n      });\r\n    }\r\n\r\n    function displayMembershipCards() {\r\n      let gridHtml = '';\r\n\r\n      // No memberships: show status + join card\r\n      if (!membershipData.has_membership || !membershipData.memberships.length) {\r\n        gridHtml += getMembershipStatusCard('none');\r\n        gridHtml += getJoinMembershipCard();\r\n      } else {\r\n        // active = any membership whose to_date >= now\r\n        const now = new Date();\r\n        const activeMemberships = membershipData.memberships.filter(m => new Date(m.to_date) >= now);\r\n        const expiredMemberships = membershipData.memberships.filter(m => new Date(m.to_date) < now);\r\n\r\n        if (activeMemberships.length > 0) {\r\n          gridHtml += getMembershipStatusCard('active', activeMemberships, expiredMemberships);\r\n          // Don't show join\r\n        } else {\r\n          gridHtml += getMembershipStatusCard('expired', [], expiredMemberships);\r\n          gridHtml += getJoinMembershipCard();\r\n        }\r\n      }\r\n\r\n      $('#membership-grid').html(gridHtml);\r\n    }\r\n\r\n    function getMembershipStatusCard(type, active=[], expired=[]) {\r\n      let badge = '';\r\n      let label = '';\r\n      let extra = '';\r\n      let periodList = '';\r\n      if (type === 'none') {\r\n        badge = `<span class=\"status-badge expired\">No Membership</span>`;\r\n        label = `<p class=\"mt-2 text-muted\">You do not have a membership yet.</p>`;\r\n      } else if (type === 'active') {\r\n        badge = `<span class=\"status-badge\">Active</span>`;\r\n        label = `<p class=\"mt-2\">You currently have an active membership.</p>`;\r\n        // Show just dates\r\n        if (active.length) {\r\n          periodList += `<div class=\"membership-item\"><strong>Valid:</strong> ${formatPeriod(active[0])}</div>`;\r\n        }\r\n        // If there's expired too, show it below with a heading\r\n        if (expired.length) {\r\n          extra += `<div class=\"divider\"></div><div class=\"small text-muted mb-1\">Previous Memberships</div>`;\r\n          expired.forEach(m => {\r\n            extra += `<div class=\"membership-item\"><strong>Expired:</strong> ${formatPeriod(m)}</div>`;\r\n          });\r\n        }\r\n      } else if (type === 'expired') {\r\n        badge = `<span class=\"status-badge expired\">Expired</span>`;\r\n        label = `<p class=\"mt-2\">Your membership has expired. Please join again!</p>`;\r\n        // Only show last expired membership period\r\n        if (expired.length) {\r\n          periodList += `<div class=\"membership-item\"><strong>Ended:</strong> ${formatPeriod(expired[0])}</div>`;\r\n        }\r\n        if (expired.length > 1) {\r\n          extra += `<div class=\"divider\"></div><div class=\"small text-muted mb-1\">Previous Memberships</div>`;\r\n          expired.slice(1).forEach(m => {\r\n            extra += `<div class=\"membership-item\"><strong>Ended:</strong> ${formatPeriod(m)}</div>`;\r\n          });\r\n        }\r\n      }\r\n\r\n      return `\r\n        <div class=\"card membership-card shadow-sm\" id=\"membership-status-card\">\r\n          <div class=\"card-header\">\r\n            <h4 class=\"h6 mb-0\">Your Membership Status</h4>\r\n          </div>\r\n          <div class=\"card-body p-3 text-center\">\r\n            ${badge}\r\n            ${label}\r\n            ${periodList}\r\n            ${extra}\r\n          </div>\r\n        </div>\r\n      `;\r\n    }\r\n\r\n    function formatPeriod(m) {\r\n      const fromDate = new Date(m.from_date).toLocaleDateString();\r\n      const toDate = new Date(m.to_date).toLocaleDateString();\r\n      return `${fromDate} &mdash; ${toDate}`;\r\n    }\r\n\r\n    function getJoinMembershipCard() {\r\n      return `\r\n        <div class=\"card membership-card shadow-sm\" id=\"join-membership-card\">\r\n          <div class=\"card-header\">\r\n            <h4 class=\"h6 mb-0\">Join Membership</h4>\r\n          </div>\r\n          <div class=\"card-body p-3\">\r\n            <div class=\"mb-3\">\r\n              <h5 class=\"h6 mb-1 text-primary\">Benefits</h5>\r\n              <ul class=\"mb-0\">\r\n                <li>Access to thousands of books</li>\r\n                <li>Online reservation system</li>\r\n                <li>Extended borrowing periods</li>\r\n                <li>Priority access to new releases</li>\r\n                <li>Reading clubs and events</li>\r\n              </ul>\r\n            </div>\r\n            <hr class=\"divider\">\r\n            <div class=\"py-2 text-center\">\r\n              <h3 class=\"h6 mb-1 text-success\">Free</h3>\r\n              <p class=\"text-muted mb-2\" style=\"font-size:0.96rem;\">One Year Membership</p>\r\n              <button class=\"btn btn-primary w-100 btn-sm py-1 px-1\" id=\"join-membership-btn\" onclick=\"joinMembership()\" style=\"font-size:0.99rem;\">Join Now</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      `;\r\n    }\r\n\r\n    function showSuccess(message) {\r\n      const html = `\r\n        <div class=\"alert alert-success alert-dismissible fade show\" role=\"alert\">\r\n          <strong>Success:</strong> ${message}\r\n          <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\"></button>\r\n        </div>\r\n      `;\r\n      $('#message-container').html(html);\r\n      setTimeout(() => $('.alert').fadeOut(), 5000);\r\n    }\r\n\r\n    function showError(message) {\r\n      const html = `\r\n        <div class=\"alert alert-danger alert-dismissible fade show\" role=\"alert\">\r\n          <strong>Error:</strong> ${message}\r\n          <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\"></button>\r\n        </div>\r\n      `;\r\n      $('#message-container').html(html);\r\n      setTimeout(() => $('.alert').fadeOut(), 5000);\r\n    }\r\n\r\n    function joinMembership() {\r\n      if (!isLoggedIn) { showError('Please log in to join membership.'); return; }\r\n\r\n      const btn = $('#join-membership-btn');\r\n      const originalText = btn.text();\r\n      btn.prop('disabled', true).html('<span class=\"spinner-border spinner-border-sm me-2\"></span>Joining...');\r\n\r\n      // Use fetch API instead of frappe.call\r\n      fetch('/api/method/library_management.api.join_membership', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'X-Frappe-CSRF-Token': getCookie('csrf_token') || '{{ frappe.session.csrf_token }}'\r\n        }\r\n      })\r\n      .then(response => response.json())\r\n      .then(data => {\r\n        btn.prop('disabled', false).text(originalText);\r\n        if (data.message && data.message.success) {\r\n          showSuccess(data.message.message);\r\n          setTimeout(loadMembershipStatus, 800);\r\n        } else {\r\n          showError(data.message?.message || 'Failed to join membership.');\r\n        }\r\n      })\r\n      .catch(error => {\r\n        btn.prop('disabled', false).text(originalText);\r\n        showError('Error joining membership.');\r\n        console.error('Error joining membership:', error);\r\n      });\r\n    }\r\n  </script>\r\n</body>\r\n</html>",
  "main_section_md": null,
  "meta_description": null,
  "meta_image": null,
  "meta_title": null,
  "modified": "2025-10-28 20:39:57.473426",
  "module": "library_management",
  "name": "membership",
  "page_blocks": [],
  "published": 1,
  "route": "membership",
  "show_sidebar": 0,
  "show_title": 0,
  "slideshow": null,
  "start_date": null,
  "text_align": "Left",
  "title": "Membership",
  "website_sidebar": null
 },
 {
  "breadcrumbs": null,
  "content_type": "HTML",
  "context_script": null,
  "css": null,
  "docstatus": 0,
  "doctype": "Web Page",
  "dynamic_route": 0,
  "dynamic_template": 0,
  "enable_comments": 0,
  "end_date": null,
  "full_width": 1,
  "header": null,
  "insert_style": 0,
  "javascript": null,
  "main_section": null,
  "main_section_html": "<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n  <meta charset=\"UTF-8\" />\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\r\n  <meta name=\"csrf-token\" content=\"{{ frappe.session.csrf_token }}\" />\r\n  <title>My Articles | Library Management</title>\r\n  <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css\"/>\r\n  <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css\"/>\r\n  {{ web_block(\"design-system\") }}\r\n  <style>\r\n    /* Hide default Frappe navbar */\r\n    .navbar-frappe,\r\n    .navbar-default,\r\n\r\n    .frappe-header,\r\n    .frappe-navbar {\r\n\r\n\r\n      display: none !important;\r\n    }\r\n    \r\n    /* Ensure our custom navbar is visible */\r\n    .custom-navbar,\r\n    .web-block-navbar {\r\n      display: block !important;\r\n    }\r\n    \r\n    /* Override any hiding for our custom navbar */\r\n    .web-block-navbar .navbar,\r\n    .web-block-navbar .navbar-brand,\r\n    .web-block-navbar .navbar-nav {\r\n      display: block !important;\r\n    }\r\n    \r\n    /* My Articles Page - Modern Design */\r\n    .my-articles-main { \r\n      max-width: 1000px; \r\n      margin: 0 auto; \r\n      padding: var(--space-16) var(--space-6); \r\n    }\r\n    \r\n    .my-articles-header {\r\n      text-align: center;\r\n      margin-bottom: var(--space-12);\r\n      padding: var(--space-8) 0;\r\n    }\r\n    \r\n    .my-articles-title { \r\n      font-size: var(--font-size-4xl);\r\n      font-weight: 800;\r\n      color: var(--neutral-900);\r\n      margin-bottom: var(--space-4);\r\n      line-height: 1.2;\r\n    }\r\n    \r\n    .my-articles-subtitle { \r\n      font-size: var(--font-size-lg);\r\n      color: var(--neutral-600);\r\n      margin-bottom: var(--space-8);\r\n    }\r\n    \r\n    .articles-grid {\r\n      display: grid;\r\n      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));\r\n      gap: var(--space-8);\r\n      margin-bottom: var(--space-12);\r\n    }\r\n    \r\n    .article-card {\r\n      background: white;\r\n      border-radius: var(--radius-2xl);\r\n      box-shadow: var(--shadow-lg);\r\n      overflow: hidden;\r\n      transition: all var(--transition-normal);\r\n      position: relative;\r\n      border: 1px solid var(--neutral-200);\r\n    }\r\n    \r\n    .article-card::before {\r\n      content: '';\r\n      position: absolute;\r\n      top: 0;\r\n      left: 0;\r\n      right: 0;\r\n      height: 4px;\r\n      background: linear-gradient(90deg, var(--primary-500), var(--primary-600));\r\n    }\r\n    \r\n    .article-card:hover {\r\n      transform: translateY(-4px);\r\n      box-shadow: var(--shadow-xl);\r\n    }\r\n    \r\n    .article-card-header {\r\n      padding: var(--space-6);\r\n      text-align: center;\r\n      background: var(--neutral-50);\r\n      border-bottom: 1px solid var(--neutral-200);\r\n    }\r\n    \r\n    .article-card-title {\r\n      font-size: var(--font-size-xl);\r\n      font-weight: 700;\r\n      color: var(--neutral-900);\r\n      margin-bottom: var(--space-2);\r\n      line-height: 1.3;\r\n    }\r\n    \r\n    .article-card-meta {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      gap: var(--space-4);\r\n      font-size: var(--font-size-sm);\r\n      color: var(--neutral-600);\r\n    }\r\n    \r\n    .article-card-meta span {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: var(--space-1);\r\n    }\r\n    \r\n    .article-card-meta i {\r\n      color: var(--primary-600);\r\n    }\r\n    \r\n    .article-card-body {\r\n      padding: var(--space-6);\r\n    }\r\n    \r\n    .article-card-info {\r\n      margin-bottom: var(--space-6);\r\n    }\r\n    \r\n    .article-card-info > div {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: var(--space-3);\r\n      margin-bottom: var(--space-3);\r\n      font-size: var(--font-size-sm);\r\n      color: var(--neutral-700);\r\n    }\r\n    \r\n    .article-card-info > div:last-child {\r\n      margin-bottom: 0;\r\n    }\r\n    \r\n    .article-card-info i {\r\n      color: var(--primary-600);\r\n      width: 16px;\r\n      text-align: center;\r\n    }\r\n    \r\n    .article-card-actions {\r\n      display: flex;\r\n      gap: var(--space-3);\r\n      margin-top: var(--space-6);\r\n    }\r\n    \r\n    .btn-return {\r\n      background: linear-gradient(135deg, var(--error-500) 0%, var(--error-600) 100%);\r\n      color: white;\r\n      border: none;\r\n      padding: var(--space-3) var(--space-6);\r\n      border-radius: var(--radius-lg);\r\n      font-size: var(--font-size-sm);\r\n      font-weight: 600;\r\n      cursor: pointer;\r\n      transition: all var(--transition-normal);\r\n      box-shadow: var(--shadow-sm);\r\n      flex: 1;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      gap: var(--space-2);\r\n    }\r\n    \r\n    .btn-return:hover {\r\n      transform: translateY(-1px);\r\n      box-shadow: var(--shadow-md);\r\n      background: linear-gradient(135deg, var(--error-600) 0%, var(--error-700) 100%);\r\n    }\r\n    \r\n    .btn-return:disabled {\r\n      opacity: 0.5;\r\n      cursor: not-allowed;\r\n      transform: none;\r\n    }\r\n    \r\n    .empty-state {\r\n      text-align: center;\r\n      padding: var(--space-16) var(--space-8);\r\n      background: white;\r\n      border-radius: var(--radius-2xl);\r\n      box-shadow: var(--shadow-lg);\r\n      border: 1px solid var(--neutral-200);\r\n    }\r\n    \r\n    .empty-state-icon {\r\n      width: 80px;\r\n      height: 80px;\r\n      background: var(--neutral-100);\r\n      border-radius: var(--radius-full);\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      margin: 0 auto var(--space-6);\r\n      color: var(--neutral-400);\r\n      font-size: var(--font-size-4xl);\r\n    }\r\n    \r\n    .empty-state h3 {\r\n      font-size: var(--font-size-2xl);\r\n      font-weight: 600;\r\n      color: var(--neutral-900);\r\n      margin-bottom: var(--space-3);\r\n    }\r\n    \r\n    .empty-state p {\r\n      color: var(--neutral-600);\r\n      margin-bottom: var(--space-6);\r\n      font-size: var(--font-size-lg);\r\n    }\r\n    \r\n    .btn-browse {\r\n      background: linear-gradient(135deg, var(--primary-600) 0%, var(--primary-700) 100%);\r\n      color: white;\r\n      text-decoration: none;\r\n      padding: var(--space-4) var(--space-8);\r\n      border-radius: var(--radius-full);\r\n      font-weight: 600;\r\n      transition: all var(--transition-normal);\r\n      box-shadow: var(--shadow-md);\r\n      display: inline-flex;\r\n      align-items: center;\r\n      gap: var(--space-2);\r\n    }\r\n    \r\n    .btn-browse:hover {\r\n      transform: translateY(-2px);\r\n      box-shadow: var(--shadow-lg);\r\n      background: linear-gradient(135deg, var(--primary-700) 0%, var(--primary-800) 100%);\r\n      color: white;\r\n    }\r\n    \r\n    .loading-state {\r\n      text-align: center;\r\n      padding: var(--space-16);\r\n    }\r\n    \r\n    .loading-spinner {\r\n      width: 40px;\r\n      height: 40px;\r\n      border: 4px solid var(--neutral-200);\r\n      border-top: 4px solid var(--primary-600);\r\n      border-radius: 50%;\r\n      animation: spin 1s linear infinite;\r\n      margin: 0 auto var(--space-4);\r\n    }\r\n    \r\n    @keyframes spin {\r\n      0% { transform: rotate(0deg); }\r\n      100% { transform: rotate(360deg); }\r\n    }\r\n    \r\n    .loading-text {\r\n      color: var(--neutral-600);\r\n      font-size: var(--font-size-lg);\r\n    }\r\n    \r\n    @media (max-width: 768px) {\r\n      .my-articles-main {\r\n        padding: var(--space-8) var(--space-4);\r\n      }\r\n      \r\n      .my-articles-title {\r\n        font-size: var(--font-size-3xl);\r\n      }\r\n      \r\n      .articles-grid {\r\n        grid-template-columns: 1fr;\r\n        gap: var(--space-6);\r\n      }\r\n      \r\n      .article-card-actions {\r\n        flex-direction: column;\r\n      }\r\n    }\r\n  </style>\r\n</head>\r\n<body>\r\n  {{ web_block(\"navbar\") }}\r\n{{ web_block(\"toast\") }}\r\n  \r\n<div class=\"my-articles-main\">\r\n  <div class=\"my-articles-header\">\r\n    <h1 class=\"my-articles-title\">My Articles</h1>\r\n    <p class=\"my-articles-subtitle\">Articles you have currently rented</p>\r\n  </div>\r\n  \r\n  <!-- Loading state -->\r\n  <div id=\"loading-state\" class=\"loading-state\">\r\n    <div class=\"loading-spinner\"></div>\r\n    <div class=\"loading-text\">Loading your articles...</div>\r\n  </div>\r\n  \r\n  <!-- Articles list container -->\r\n  <div id=\"articles-container\" style=\"display: none;\">\r\n    <div id=\"articles-list\" class=\"articles-grid\"></div>\r\n  </div>\r\n  \r\n  <!-- Empty state -->\r\n  <div id=\"empty-state\" class=\"empty-state\" style=\"display: none;\">\r\n    <div class=\"empty-state-icon\">\r\n      <i class=\"bi bi-journal-bookmark\"></i>\r\n    </div>\r\n    <h3>No Articles Rented</h3>\r\n    <p>You haven't rented any articles yet. Browse our collection to find something interesting!</p>\r\n    <a href=\"/articles-page\" class=\"btn-browse\">\r\n      <i class=\"bi bi-search\"></i>\r\n      Browse Articles\r\n    </a>\r\n  </div>\r\n  \r\n  <!-- Back button -->\r\n  <div style=\"text-align: center; margin-top: var(--space-8);\">\r\n    <a href=\"/home\" class=\"btn btn-outline-secondary\">\r\n      <i class=\"bi bi-arrow-left\"></i> Back to Home\r\n    </a>\r\n  </div>\r\n</div>\r\n\r\n<script>\r\nlet librarySettings = null;\r\n\r\n// Load library settings\r\nasync function loadLibrarySettings() {\r\n    try {\r\n        console.log('🔍 DEBUG: Loading library settings...');\r\n        const response = await fetch('/api/method/library_management.api.get_library_settings');\r\n        const result = await response.json();\r\n        \r\n        if (result.message && result.message.success) {\r\n            librarySettings = result.message;\r\n            console.log('🔍 DEBUG: Library settings loaded:', librarySettings);\r\n        } else {\r\n            console.log('🔍 DEBUG: Using default library settings');\r\n            librarySettings = {\r\n                loan_period: 14,\r\n                max_articles_per_user: 3\r\n            };\r\n        }\r\n    } catch (error) {\r\n        console.error('🔍 DEBUG: Error loading library settings:', error);\r\n        librarySettings = {\r\n            loan_period: 14,\r\n            max_articles_per_user: 3\r\n        };\r\n    }\r\n}\r\n\r\n// Get CSRF token from cookies\r\nfunction getCookie(name) {\r\n    const value = `; ${document.cookie}`;\r\n    const parts = value.split(`; ${name}=`);\r\n    if (parts.length === 2) return parts.pop().split(';').shift();\r\n}\r\n\r\nasync function getCSRFToken() {\r\n    // Try to get CSRF token from the page's global variable\r\n    if (window.frappe && window.frappe.csrf_token) {\r\n        console.log('🔍 DEBUG: Found CSRF token in window.frappe:', window.frappe.csrf_token);\r\n        return window.frappe.csrf_token;\r\n    }\r\n    \r\n    // Try different possible cookie names for CSRF token\r\n    const possibleNames = ['csrf_token', 'frappe.csrf_token', 'csrf-token', 'frappe_csrf_token'];\r\n    for (const name of possibleNames) {\r\n        const token = getCookie(name);\r\n        if (token) {\r\n            console.log('🔍 DEBUG: Found CSRF token in cookie:', name, '=', token);\r\n            return token;\r\n        }\r\n    }\r\n    \r\n    // If no cookie found, try to get it from meta tag\r\n    const metaToken = document.querySelector('meta[name=\"csrf-token\"]');\r\n    if (metaToken) {\r\n        console.log('🔍 DEBUG: Found CSRF token in meta tag:', metaToken.content);\r\n        return metaToken.content;\r\n    }\r\n    \r\n    console.log('🔍 DEBUG: No CSRF token found in cookies or meta tags');\r\n    console.log('🔍 DEBUG: Available cookies:', document.cookie);\r\n    \r\n    // Last resort: try to get CSRF token from a simple API call\r\n    try {\r\n        console.log('🔍 DEBUG: Attempting to get CSRF token from API call');\r\n        const response = await fetch('/api/method/frappe.auth.get_logged_user', {\r\n            method: 'GET'\r\n        });\r\n        \r\n        // Check if response has CSRF token in headers\r\n        const csrfToken = response.headers.get('X-Frappe-CSRF-Token');\r\n        if (csrfToken) {\r\n            console.log('🔍 DEBUG: Found CSRF token in API response headers:', csrfToken);\r\n            return csrfToken;\r\n        }\r\n        \r\n        // Try to get it from the response body\r\n        const result = await response.json();\r\n        if (result.csrf_token) {\r\n            console.log('🔍 DEBUG: Found CSRF token in API response body:', result.csrf_token);\r\n            return result.csrf_token;\r\n        }\r\n        \r\n        console.log('🔍 DEBUG: No CSRF token found in API response');\r\n        return null;\r\n    } catch (error) {\r\n        console.log('🔍 DEBUG: Error getting CSRF token from API:', error);\r\n        return null;\r\n    }\r\n}\r\n\r\n// Load rented articles on page load\r\ndocument.addEventListener('DOMContentLoaded', async function() {\r\n    await loadLibrarySettings();\r\n    loadRentedArticles();\r\n});\r\n\r\nasync function loadRentedArticles() {\r\n    console.log('🔍 DEBUG: Starting loadRentedArticles()');\r\n    try {\r\n        console.log('🔍 DEBUG: Making API call to get_rented_articles');\r\n        const response = await fetch('/api/method/library_management.api.get_rented_articles', {\r\n            method: 'GET',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'X-Frappe-CSRF-Token': getCookie('csrf_token')\r\n            }\r\n        });\r\n        \r\n        console.log('🔍 DEBUG: API response status:', response.status);\r\n        console.log('🔍 DEBUG: API response headers:', response.headers);\r\n        \r\n        const result = await response.json();\r\n        console.log('🔍 DEBUG: Full API response:', result);\r\n        \r\n        if (result.message && result.message.success) {\r\n            const articles = result.message.data || [];\r\n            console.log('🔍 DEBUG: Found articles:', articles);\r\n            console.log('🔍 DEBUG: Article count:', articles.length);\r\n            \r\n            document.getElementById('loading-state').style.display = 'none';\r\n            console.log('🔍 DEBUG: Loading state hidden');\r\n            \r\n            if (articles.length > 0) {\r\n                console.log('🔍 DEBUG: Displaying articles');\r\n                displayArticles(articles);\r\n            } else {\r\n                console.log('🔍 DEBUG: No articles found, showing empty state');\r\n                showEmptyState();\r\n            }\r\n        } else {\r\n            console.log('🔍 DEBUG: API returned error:', result.message);\r\n            document.getElementById('loading-state').style.display = 'none';\r\n            showErrorState(result.message ? result.message.message : 'Failed to load articles');\r\n        }\r\n    } catch (error) {\r\n        console.error('🔍 DEBUG: Error loading rented articles:', error);\r\n        document.getElementById('loading-state').style.display = 'none';\r\n        showErrorState('Network error. Please refresh the page.');\r\n    }\r\n}\r\n\r\nfunction displayArticles(articles) {\r\n    console.log('🔍 DEBUG: displayArticles called with:', articles);\r\n    const container = document.getElementById('articles-container');\r\n    console.log('🔍 DEBUG: Container element:', container);\r\n    container.style.display = 'block';\r\n    \r\n    const listDiv = document.createElement('div');\r\n    listDiv.className = 'articles-grid';\r\n    console.log('🔍 DEBUG: Created listDiv:', listDiv);\r\n    \r\n    articles.forEach((article, index) => {\r\n        console.log(`🔍 DEBUG: Processing article ${index}:`, article);\r\n        const cardDiv = document.createElement('div');\r\n        cardDiv.className = 'article-card';\r\n        \r\n        // Calculate due date (rental_date + loan period from settings)\r\n        const rentalDate = new Date(article.rental_date);\r\n        const dueDate = new Date(rentalDate);\r\n        const loanPeriod = librarySettings ? librarySettings.loan_period : 14;\r\n        dueDate.setDate(dueDate.getDate() + loanPeriod);\r\n        \r\n        cardDiv.innerHTML = `\r\n            <div class=\"article-card-header\">\r\n                <h3 class=\"article-card-title\">${article.title || article.article}</h3>\r\n                <div class=\"article-card-meta\">\r\n                    <span><i class=\"bi bi-calendar\"></i> Rented: ${formatDate(article.rental_date)}</span>\r\n                </div>\r\n            </div>\r\n            <div class=\"article-card-body\">\r\n                <div class=\"article-card-info\">\r\n                    ${article.author ? `<div><i class=\"bi bi-person\"></i> <strong>Author:</strong> ${article.author}</div>` : ''}\r\n                    ${article.publisher ? `<div><i class=\"bi bi-building\"></i> <strong>Publisher:</strong> ${article.publisher}</div>` : ''}\r\n                    ${article.isbn ? `<div><i class=\"bi bi-upc-scan\"></i> <strong>ISBN:</strong> ${article.isbn}</div>` : ''}\r\n                    <div><i class=\"bi bi-calendar-check\"></i> <strong>Due:</strong> ${formatDate(dueDate)}</div>\r\n                </div>\r\n                <div class=\"article-card-actions\">\r\n                    <a href=\"/article-detail?article_name=${article.article}\" class=\"btn btn-outline-primary btn-sm\">\r\n                        <i class=\"bi bi-eye\"></i> View Details\r\n                    </a>\r\n                    <button onclick=\"returnArticle('${article.transaction_id}')\" class=\"btn-return\">\r\n                        <i class=\"bi bi-arrow-return-left\"></i> Return Article\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        `;\r\n        \r\n        listDiv.appendChild(cardDiv);\r\n    });\r\n    \r\n    console.log('🔍 DEBUG: About to append listDiv to container');\r\n    console.log('🔍 DEBUG: listDiv children count:', listDiv.children.length);\r\n    console.log('🔍 DEBUG: Container before append:', container);\r\n    container.appendChild(listDiv);\r\n    console.log('🔍 DEBUG: Container after append:', container);\r\n    console.log('🔍 DEBUG: Container children count:', container.children.length);\r\n}\r\n\r\nfunction showEmptyState() {\r\n    document.getElementById('empty-state').style.display = 'block';\r\n}\r\n\r\nfunction showErrorState(message) {\r\n    const container = document.getElementById('articles-container');\r\n    container.style.display = 'block';\r\n    container.innerHTML = `\r\n    <div class=\"custom-alert custom-alert-warning\">\r\n            <i class=\"bi bi-exclamation-circle\"></i> ${message}\r\n    </div>\r\n        <button onclick=\"loadRentedArticles()\" class=\"custom-btn custom-btn-outline-primary\">\r\n            <i class=\"bi bi-arrow-clockwise\"></i> Try Again\r\n        </button>\r\n    `;\r\n}\r\n\r\nfunction formatDate(date) {\r\n    const d = new Date(date);\r\n    const options = { year: 'numeric', month: 'long', day: 'numeric' };\r\n    return d.toLocaleDateString('en-US', options);\r\n}\r\n\r\n\r\nasync function returnArticle(transactionId) {\r\n    console.log('🔍 DEBUG: Starting returnArticle() with transactionId:', transactionId);\r\n    \r\n    if (!confirm('Are you sure you want to return this article?')) {\r\n        console.log('🔍 DEBUG: User cancelled return');\r\n        return;\r\n    }\r\n    \r\n    try {\r\n        console.log('🔍 DEBUG: Creating JSON data for return request');\r\n        const requestData = {\r\n            transaction: transactionId\r\n        };\r\n        \r\n        console.log('🔍 DEBUG: Request data:', requestData);\r\n        \r\n        console.log('🔍 DEBUG: Making API call to return_article');\r\n        const csrfToken = await getCSRFToken();\r\n        console.log('🔍 DEBUG: Using CSRF token:', csrfToken);\r\n        \r\n        const headers = {\r\n            'Content-Type': 'application/json'\r\n        };\r\n        \r\n        // Only add CSRF token if we have one\r\n        if (csrfToken && csrfToken !== 'None' && csrfToken !== '{{ frappe.session.csrf_token }}') {\r\n            headers['X-Frappe-CSRF-Token'] = csrfToken;\r\n            console.log('🔍 DEBUG: Added CSRF token to headers');\r\n        } else {\r\n            console.log('🔍 DEBUG: No valid CSRF token, making request without it');\r\n        }\r\n        \r\n        // Use POST method with JSON data\r\n        console.log('🔍 DEBUG: Trying POST method with JSON');\r\n        const response = await fetch('/api/method/library_management.api.return_article', {\r\n            method: 'POST',\r\n            headers: headers,\r\n            body: JSON.stringify(requestData)\r\n        });\r\n        \r\n        console.log('🔍 DEBUG: Return API response status:', response.status);\r\n        console.log('🔍 DEBUG: Return API response headers:', response.headers);\r\n        \r\n        const result = await response.json();\r\n        console.log('🔍 DEBUG: Full return API response:', result);\r\n        \r\n        console.log('🔍 DEBUG: Checking result structure:', {\r\n            hasMessage: !!result.message,\r\n            messageType: typeof result.message,\r\n            messageContent: result.message,\r\n            hasSuccess: result.message ? !!result.message.success : false,\r\n            successValue: result.message ? result.message.success : 'N/A',\r\n            directSuccess: result.success,\r\n            directMessage: result.message\r\n        });\r\n        \r\n        // Check both possible response formats\r\n        if ((result.message && result.message.success === true) || result.success === true) {\r\n            console.log('🔍 DEBUG: Return successful, showing toast');\r\n            showToast('Article returned successfully!', 'success', 3000);\r\n            // Force reload immediately to update the UI\r\n            setTimeout(() => { \r\n                console.log('🔍 DEBUG: Reloading page after successful return');\r\n                window.location.reload(); \r\n            }, 1000);\r\n        } else {\r\n            console.log('🔍 DEBUG: Return failed:', result.message);\r\n            const errorMsg = (result.message && result.message.message) ? result.message.message : \r\n                           (result.message && typeof result.message === 'string') ? result.message :\r\n                           'Failed to return article.';\r\n            showToast(errorMsg, 'error', 5000);\r\n        }\r\n    } catch (error) {\r\n        console.error('🔍 DEBUG: Return article error:', error);\r\n        showToast('Network error. Please try again.', 'error', 5000);\r\n    }\r\n}\r\n\r\n</script>\r\n</body>\r\n</html>",
  "main_section_md": null,
  "meta_description": null,
  "meta_image": null,
  "meta_title": null,
  "modified": "2025-10-28 20:39:57.473426",
  "module": "library_management",
  "name": "my-articles",
  "page_blocks": [],
  "published": 1,
  "route": "my-articles",
  "show_sidebar": 0,
  "show_title": 0,
  "slideshow": null,
  "start_date": null,
  "text_align": "Left",
  "title": "My Articles",
  "website_sidebar": null
 }
]
